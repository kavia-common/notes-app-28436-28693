{"is_source_file": true, "format": "Python", "description": "This file implements security-related functionalities for a FastAPI backend, including password hashing, token creation, and user authentication/authorization handling with JWT and OAuth2 schemes.", "external_files": ["app.core.config", "app.db.session", "app.models.user"], "external_methods": ["bcrypt.gensalt", "bcrypt.hashpw", "bcrypt.checkpw", "jwt.encode", "jwt.decode", "select", "get_session"], "published": ["get_current_user", "get_preview_or_current_user"], "classes": [{"name": "User", "description": "User model representing application users, used for authentication and authorization."}], "methods": [{"name": "str get_password_hash(password: str)", "description": "Generates a bcrypt hash for a given password.", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(password: str, hashed: str)", "description": "Verifies that a password matches a stored bcrypt hash.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(data: dict, expires_delta: Optional[timedelta] = None)", "description": "Creates a JWT token with optional expiration.", "scope": "", "scopeKind": ""}, {"name": "User get_current_user(token: str = Depends(oauth2_scheme), session: AsyncSession = Depends(get_session))", "description": "Decodes a JWT token and retrieves the corresponding user from the database.", "scope": "", "scopeKind": ""}, {"name": "User get_preview_or_current_user( session: AsyncSession = Depends(get_session), credentials: Optional[HTTPAuthorizationCredentials] = Depends(oauth2_scheme_optional) )", "description": "Returns a stub user in preview mode or authenticates user via token.", "scope": "", "scopeKind": ""}], "calls": ["bcrypt.gensalt", "bcrypt.hashpw", "bcrypt.checkpw", "jwt.encode", "jwt.decode", "select", "session.execute", "get_session", "datetime.utcnow", "User() constructor"], "search-terms": ["JWT authentication", "FastAPI security dependencies", "Password hashing bcrypt", "Token creation JWT", "Preview mode authentication", "OAuth2PasswordBearer token"], "state": 2, "file_id": 9, "knowledge_revision": 65, "git_revision": "ce6636720be27aa04dedd08d8cd1a57d34dabf5b", "revision_history": [{"27": ""}, {"58": "ce6636720be27aa04dedd08d8cd1a57d34dabf5b"}, {"59": "ce6636720be27aa04dedd08d8cd1a57d34dabf5b"}, {"60": "ce6636720be27aa04dedd08d8cd1a57d34dabf5b"}, {"65": "ce6636720be27aa04dedd08d8cd1a57d34dabf5b"}], "ctags": [{"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/notes-app-28436-28693/BackendAPIContainer/src/app/core/security.py", "pattern": "/^def create_access_token(data: dict, expires_delta: Optional[timedelta] = None) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: dict, expires_delta: Optional[timedelta] = None)"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/notes-app-28436-28693/BackendAPIContainer/src/app/core/security.py", "pattern": "/^async def get_current_user(token: str = Depends(oauth2_scheme), session: AsyncSession = Depends(/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(token: str = Depends(oauth2_scheme), session: AsyncSession = Depends(get_session))"}, {"_type": "tag", "name": "get_password_hash", "path": "/home/kavia/workspace/code-generation/notes-app-28436-28693/BackendAPIContainer/src/app/core/security.py", "pattern": "/^def get_password_hash(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "get_preview_or_current_user", "path": "/home/kavia/workspace/code-generation/notes-app-28436-28693/BackendAPIContainer/src/app/core/security.py", "pattern": "/^async def get_preview_or_current_user($/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "( session: AsyncSession = Depends(get_session), credentials: Optional[HTTPAuthorizationCredentials] = Depends(oauth2_scheme_optional) )"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/notes-app-28436-28693/BackendAPIContainer/src/app/core/security.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "oauth2_scheme_optional", "path": "/home/kavia/workspace/code-generation/notes-app-28436-28693/BackendAPIContainer/src/app/core/security.py", "pattern": "/^oauth2_scheme_optional = HTTPBearer(auto_error=False)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/notes-app-28436-28693/BackendAPIContainer/src/app/core/security.py", "pattern": "/^def verify_password(password: str, hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(password: str, hashed: str)"}], "hash": "2d0944e0f3fba94d675643cf544751c6", "format-version": 4, "code-base-name": "BackendAPIContainer", "filename": "BackendAPIContainer/src/app/core/security.py", "fields": [{"name": "oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "oauth2_scheme_optional = HTTPBearer(auto_error=False)", "scope": "", "scopeKind": "", "description": "unavailable"}]}